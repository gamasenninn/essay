# 近況報告 － 機器制御の場合はバックエンド優先。画面デザインなんてくそくらえ、です

kotlinでandroid端末の基本の機器制御周りを  
コーデングしているのじゃが  

bluetoothがどうしてもclaimできずに困っていた  
manifestに記述しても  
プログラムでパーミッションをコントロールしても  
エラーばかりで先がすすまない  

ためしに
android側のアプリの設定で
bluetooth
位置情報
などのパーミッションを
あらかじめ許可してみたら  
あっさり成功した  
ここまでくるのにまる2日かかった  
なんでなのか、よくわかっていないのじゃが  
ゆくゆく原因を究明するとして  
やっとこの先にすすめそうだ  

機器との接続さえできれば  
あとは、じっくり個々のリクエストの  
テストプラグラムを書いていけばよい  

機器関連の制御システムは  
機能を小さく分割して
先にテストプログラムを書くのがよい
テストプログラムを書いているうちに
制御の肝がわかってくるし  
先にエラーの種類や対応がわかってくる  
仕様にある状態遷移も  
テストプログラムである程度  
シミュレーションできるようになる  

それができたあとは  
ユーザーインターフェエースは  
めちゃ楽に構築できる  

絶対やってはいけないことは  
ユーザーインターフェースの  
見た目にこだわって  
先に凝った画面とかを作ってしまうことだ  
機器制御においては
まずは画面の見た目なんてどうでもいい  
状態遷移表どおりに動くことが最重要である  
その上で必要最小限のユーザーインターフェースを作り  
必要に応じて拡張していくこと  

その意味で機器制御系システムは
絶対にデザイン優先のSEと組んではいけない  
（組込系ではそんなやついないが）
バックエンド優先のSEと組むこと

これが仙人流の
制御関連システムの基本的な攻略法である  

