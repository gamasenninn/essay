# 近況報告 － MS Accessは最初から32ビット版を使おう    

先日、リモートワークで実作業したとき、  
MS Accessで作られたアプリケーションを使う必要があった  
そのさい、いろいろ問題があったので
備忘のために書き残しておく  

現在使っているACCESSアプリケーションは  
ODBCでオンプレ環境のMySQLに接続しており    
商品マスターは約10万件  
出品マスターは約3万件  

VPN接続した場合  
このオンプレDBにODBC経由でも接続できるようにした  
たんにMySQLのOBCDドライバーを使うだけなので  
当然、接続試験はすんなり通る

楽勝ムード、勝ったも同然な気分で  
ACCESSアプリを立ち上げていざDBにリンクしようと思ったら  
自動起動のアプリが写真のようなエラーを吐き出した  
VBAプログラムが64ビット対応ではないというエラーね  

対策としてはシンプルで  
Declareとしているところを 
Dclare ptrSafeという記述に変えるだけでよい  
って簡単にいうけど  
巨大なソースコード群なので  
意外にもその記述が多い

面倒くさいが手作業で変えた
結構、時間がかかった

アプリを再起動した  
うまく通り、エラーもなく  
通常にアプリが使えるようになった  

よかった、よかった・・・・

だが、ちょっと考えると  
これだと、64版と32版のアプリができてしまい  
ちょこちょこと変更があるアプリなので
バージョン管理が面倒になる

どうしたものかと考えていたところ  
すぐに結論が出た   
「リモート環境のMS ACCESSを32ビットに変更すればよい」  
実に簡単なことなんだが、
これならプログラムの変更はしなくてよい

なんで最初から32ビット版をインストールしなかったんだろう？  
手が反射的に64ビット版を選んでいたようだが  
考えもなしに猿のようにインストールするのは  
やっぱまずいよなってことだな  

